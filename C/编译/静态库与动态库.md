<!--
 * @Description: 
 * @Version: 1.0
 * @Author: DaLao
 * @Email: dalao_li@163.com
 * @Date: 2022-08-15 23:02:04
 * @LastEditors: DaLao
 * @LastEditTime: 2022-08-17 00:39:32
-->


## 库


### 目标代码

hello.h

```c
#ifndef HELLO_H
#define HELLO_H

void hello();

#endif
```

hello.c

```c
#include <stdio.h>

void hello()
{
    printf("Hello World!\n");
}
```

main.c

```c
#include "hello.h"

int main(void)
{
    hello();
    return 0;
}
```

### 静态库

#### 编译 hello.o

```c
gcc -c hello.c
```

- c

只激活预处理,编译,和汇编,也就是他只把程序做成obj文件

#### 创建静态库

```c
ar -crv libhello.a hello.o
```

- ar

- crv

#### 链接静态库

```c
gcc main.c libhello.a -o main
```


#### 运行

```c
./main
```

删除静态库后对程序无影响

```c
sudo rm libhello.a

./main
```

### 动态库


#### 创建动态库

```c
gcc -shared -fPIC -o libhello.so hello.o
```

- shared

此选项将尽量使用动态库，所以生成文件比较小, 但是需要系统由动态库

- fPIC

fPIC的全称是 Position Independent Code, 用于生成位置无关代码


#### 链接为可执行文件

```c
gcc main.c libhello.so -o main
```


#### 运行

报找不到库文件错误, 移动动态库

```c
sudo mv libhello.so /usr/lib

./main
```
